---
title: Evaluación de vulnerabilidades de máquina virtual BYOL en Azure Security Center
description: Implemente una solución de evaluación de vulnerabilidades BYOL en Azure Virtual Machines para obtener recomendaciones de Azure Security Center que le ayuden a proteger las máquinas virtuales.
author: memildin
manager: rkarlin
ms.service: security-center
ms.topic: how-to
ms.date: 03/17/2021
ms.author: memildin
ms.openlocfilehash: 4c71f80585605cf749042a4319d80dc8e69a856b
ms.sourcegitcommit: 860f6821bff59caefc71b50810949ceed1431510
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/09/2021
ms.locfileid: "129715373"
---
# <a name="deploy-a-bring-your-own-license-byol-vulnerability-assessment-solution"></a>Implemente una solución de evaluación de vulnerabilidades BYOL (traiga su propia licencia)

Si habilitó **Azure Defender para servidores**, puede usar la herramienta de evaluación de vulnerabilidades integrada de Azure Security Center, tal y como se describe en [Detector de vulnerabilidades de Qualys integrado en Azure Defender para Azure y máquinas híbridas](./deploy-vulnerability-assessment-vm.md). Esta herramienta se integra en Azure Defender y no requiere ninguna licencia externa, todo se controla sin problemas en Security Center. Además, el analizador integrado admite máquinas habilitadas para Azure Arc.

Como alternativa, es posible que quiera implementar su propia solución de evaluación de vulnerabilidades con licencia privada de [Qualys](https://www.qualys.com/lp/azure) o [Rapid7](https://www.rapid7.com/products/insightvm/). Puede instalar una de estas soluciones de asociados en varias máquinas virtuales que pertenezcan a la misma suscripción (pero no máquinas habilitadas para Azure Arc).

## <a name="availability"></a>Disponibilidad

|Aspecto|Detalles|
|----|:----|
|Estado de la versión:|Disponibilidad general (GA)|
|Tipos de máquina:|:::image type="icon" source="./media/icons/yes-icon.png"::: Máquinas virtuales de Azure<br>:::image type="icon" source="./media/icons/no-icon.png"::: Máquinas habilitadas para Azure Arc|
|Precios:|Gratuito|
|Roles y permisos necesarios:|**El propietario del recurso** puede implementar el analizador.<br>El **Lector de seguridad** puede ver los resultados.|
|Nubes:|:::image type="icon" source="./media/icons/yes-icon.png"::: Nubes comerciales<br>:::image type="icon" source="./media/icons/no-icon.png"::: Nacionales o soberanas (Azure Government y Azure China 21Vianet)|
|||


## <a name="deploy-a-byol-solution-from-the-azure-portal"></a>Implementación de una solución BYOL desde Azure Portal

Las opciones BYOL hacen referencia a soluciones de evaluación de vulnerabilidades de terceros compatibles. Actualmente se admiten los proveedores de Qualys y Rapid7.

Las soluciones compatibles notifican los datos de vulnerabilidades a la plataforma de administración del asociado. A su vez, esa plataforma proporciona datos de supervisión del estado y las vulnerabilidades a Security Center. Puede identificar las máquinas virtuales vulnerables desde el panel de Security Center y conmutar a la consola de administración de socios comerciales directamente desde Security Center para más información e informes.

1. En [Azure Portal](https://azure.microsoft.com/features/azure-portal/), abra **Security Center**.

1. En el menú de Security Center, abra la página **Recomendaciones**.

1. Seleccione la recomendación **La solución de evaluación de vulnerabilidades debe estar habilitada en sus máquinas virtuales**.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png" alt-text="Las agrupaciones de las máquinas en la página de la recomendación **La solución de evaluación de vulnerabilidades debe estar habilitada en sus máquinas virtuales**" lightbox="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png":::

    Las máquinas virtuales aparecerán en uno o varios de los siguientes grupos:

    * **Recursos correctos**: Security Center ha detectado una solución de evaluación de vulnerabilidades que se ejecuta en estas máquinas virtuales.
    * **Recursos incorrectos**: la extensión del detector de vulnerabilidades se puede implementar en estas máquinas virtuales. 
    * **Recursos no aplicables**: no se puede implementar la extensión del detector de vulnerabilidades en estas máquinas virtuales.

1. En la lista de máquinas incorrectas, seleccione las que recibirán una solución de evaluación de vulnerabilidades y seleccione **Corregir**.

    >[!IMPORTANT]
    > En función de la configuración, es posible que solo vea un subconjunto de esta lista. 
    >
    > - Si no tiene un detector de vulnerabilidades de terceros configurado, no se le ofrecerá la oportunidad de implementarlo.
    > - Si las máquinas virtuales seleccionadas no están protegidas con Azure Defender, la opción de detector de vulnerabilidades integrado de ASC no estará disponible.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-remediation-options.png" alt-text="Las opciones para el tipo de flujo de corrección que quiere elegir al responder a la recomendación de la página **La solución de evaluación de vulnerabilidades debe estar habilitada en sus máquinas virtuales**":::

1. Si va a establecer una nueva configuración de BYOL, seleccione **Configure a new third-party vulnerability scanner** (Configurar un nuevo detector de vulnerabilidades de terceros), seleccione la extensión correspondiente, **Continuar** y escriba los detalles del proveedor de la siguiente manera:

    1. En **Grupo de recursos**, seleccione **Usar existente**. Si posteriormente elimina este grupo de recursos, la solución BYOL no estará disponible.
    1. En **Ubicación**, seleccione el lugar en el que la solución se encuentra geográficamente localizada.
    1. Para Qualys, escriba la licencia proporcionada por Qualys en el campo **Código de licencia**.
    1. Para Rapid7, cargue el **archivo de configuración de Rapid7**.
    1. En el cuadro **Clave pública**, escriba la información de la clave pública que proporciona el asociado.
    1. Para instalar automáticamente un agente de evaluación de vulnerabilidades en todas las VM detectadas en la suscripción de esta solución Qualys, seleccione **Implementación automática**.
    1. Seleccione **Aceptar**.

1. Si ya ha configurado la solución BYOL, seleccione **Deploy your configured third-party vulnerability scanner** (Implementar el detector de vulnerabilidades de terceros configurado), seleccione la extensión correspondiente y luego **Continuar**.

Una vez instalada la solución de evaluación de vulnerabilidades en las máquinas de destino, Security Center ejecuta un análisis para detectar e identificar las vulnerabilidades en el sistema y en la aplicación. El primer examen puede tardar un par de horas en completarse. Después, se ejecuta cada hora.



## <a name="deploy-a-byol-solution-using-powershell-and-the-rest-api"></a>Implementación de una solución BYOL mediante PowerShell y la API REST

Para implementar mediante programación su propia solución de valoración de vulnerabilidades con licencia privada desde [Qualys](https://www.qualys.com/lp/azure) o [Rapid7](https://www.rapid7.com/products/insightvm/), use el script proporcionado [PowerShell > Solución de vulnerabilidad](https://github.com/Azure/Azure-Security-Center/tree/master/Powershell%20scripts/Vulnerability%20Solution). Este script usa la API de REST para crear una nueva solución de seguridad en ASC. Necesitará una licencia y una clave que proporciona el proveedor de servicios (Qualys o Rapid7).

> [!IMPORTANT] 
> Solo se puede crear una solución por licencia. Se producirá un error al intentar crear otra solución con el mismo nombre, licencia o clave.

### <a name="prerequisites"></a>Prerrequisitos

Módulos de PowerShell necesarios:

- Install-module Az
- Install-module Az.security

### <a name="run-the-script"></a>Ejecute el script.

Para ejecutar el script, necesitará la información pertinente para los parámetros siguientes.

| **Parámetro** | **Obligatorio** | **Notas** |
|----|:----:|----|
|**SubscriptionId**|✔|Valor de subscriptionID de la suscripción de Azure que contiene los recursos que quiere analizar.|
|**ResourceGroupName**|✔|Nombre del grupo de recursos. Use cualquier grupo de recursos existente que incluya el valor predeterminado ("DefaultResourceGroup-xxx").<br>Dado que la solución no es un recurso de Azure, no aparecerá en el grupo de recursos, pero está conectada a este. Si posteriormente elimina el grupo de recursos, la solución BYOL no estará disponible.|
|**vaSolutionName**|✔|Nombre de la nueva solución.|
|**vaType**|✔|Qualys o Rapid7.|
|**licenseCode**|✔|Cadena de licencia proporcionada por el proveedor.|
|**publicKey**|✔|Clave pública proporcionada por el proveedor.|
|**autoUpdate**|-|Habilite (true) o deshabilite (false) la implementación automática para esta solución de VA. Cuando está habilitada, todas las VM nuevas de la suscripción intentarán vincularse automáticamente a la solución.<br/>(Valor predeterminado: False)|
||||

Sintaxis:

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId <Subscription Id> -resourceGroupName <RG Name>
-vaSolutionName <New solution name> -vaType <Qualys / Rapid7> -autoUpdate <true/false>
-licenseCode <License code from vendor> -publicKey <Public Key received from vendor>
```

Ejemplo (en este ejemplo no se incluyen detalles de licencia válidos):

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId 'f4cx1b69-dtgb-4ch6-6y6f-ea2e95373d3b' -resourceGroupName 'DefaultResourceGroup-WEU' -vaSolutionName 'QualysVa001' -vaType 'Qualys' -autoUpdate 'false' `
-licenseCode 'eyJjaWQiOiJkZDg5OTYzXe4iMTMzLWM4NTAtODM5FD2mZWM1N2Q3ZGU5MjgiLCJgbTYuOiIyMmM5NDg3MS1lNTVkLTQ1OGItYjhlMC03OTRhMmM3YWM1ZGQiLCJwd3NVcmwiOiJodHRwczovL3FhZ3B1YmxpYy1wMDEuaW50LnF1YWx5cy5jb20vQ2xvdSKJY6VudC8iLCJwd3NQb3J0IjoiNDQzIn0=' `
-publicKey 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOiOLXjOywMfLZIBGPZLwSocf1Q64GASLK9OHFEmanBl1nkJhZDrZ4YD5lM98fThYbAx1Rde2iYV1ze/wDlX4cIvFAyXuN7HbdkeIlBl6vWXEBZpUU17bOdJOUGolzEzNBhtxi/elEZLghq9Chmah82me/okGMIhJJsCiTtglVQIDAQAB'
```

## <a name="faq---byol-vulnerability-scanner"></a>Preguntas frecuentes: detector de vulnerabilidades BYOL

- [Si implemento un agente de Qualys, ¿qué configuración de comunicaciones se necesita?](#if-i-deploy-a-qualys-agent-what-communications-settings-are-required)
- [¿Por qué tengo que especificar un grupo de recursos al configurar una solución BYOL?](#why-do-i-have-to-specify-a-resource-group-when-configuring-a-byol-solution)


### <a name="if-i-deploy-a-qualys-agent-what-communications-settings-are-required"></a>Si implemento un agente de Qualys, ¿qué configuración de comunicaciones se necesita?

Qualys Cloud Agent está diseñado para comunicarse con el SOC de Qualys a intervalos regulares para recibir actualizaciones, así como para realizar las distintas operaciones necesarias para la funcionalidad del producto. Para permitir que el agente se comunique sin problemas con el SOC, configure la seguridad de red para permitir el tráfico entrante y saliente a las direcciones URL del SOC de Qualys.

Hay varias plataformas de Qualys en varias ubicaciones geográficas. El CIDR y las direcciones URL de SOC variarán en función de la plataforma de host de su suscripción a Qualys. Para identificar la plataforma de host de Qualys, use la siguiente página: https://www.qualys.com/platform-identification/.


### <a name="why-do-i-have-to-specify-a-resource-group-when-configuring-a-byol-solution"></a>¿Por qué tengo que especificar un grupo de recursos al configurar una solución BYOL?

Al configurar la solución, debe elegir un grupo de recursos al que adjuntarla. La solución no es un recurso de Azure, por lo que no se incluirá en la lista de recursos del grupo de recursos. No obstante, se adjunta a ese grupo de recursos. Si posteriormente elimina el grupo de recursos, la solución BYOL no estará disponible.



## <a name="next-steps"></a>Pasos siguientes

> [!div class="nextstepaction"]
> [Corrección de los resultados de las soluciones de evaluación de vulnerabilidades](remediate-vulnerability-findings-vm.md)


Security Center también ofrece análisis de vulnerabilidades para:

- SQL Database: consulte [Exploración de los informes de evaluación de vulnerabilidades en el panel de evaluación de vulnerabilidades](defender-for-sql-on-machines-vulnerability-assessment.md#explore-vulnerability-assessment-reports).
- Imágenes de Azure Container Registry: consulte [Uso de Azure Defender para registros de contenedor para examinar las imágenes en busca de vulnerabilidades](defender-for-container-registries-usage.md)