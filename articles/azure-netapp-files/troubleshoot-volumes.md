---
title: Solución de errores de volúmenes de Azure NetApp Files | Microsoft Docs
description: Aquí se describen los mensajes de error y las resoluciones que pueden ayudar a solucionar los problemas de los volúmenes de Azure NetApp Files.
services: azure-netapp-files
documentationcenter: ''
author: b-juche
manager: ''
editor: ''
ms.assetid: ''
ms.service: azure-netapp-files
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: troubleshooting
ms.date: 10/04/2021
ms.author: b-juche
ms.openlocfilehash: f46b6f0c0648dcc354f170548a4273188c4871e6
ms.sourcegitcommit: 692382974e1ac868a2672b67af2d33e593c91d60
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/22/2021
ms.locfileid: "130219742"
---
# <a name="troubleshoot-volume-errors-for-azure-netapp-files"></a>Solución de errores de volúmenes de Azure NetApp Files

En este artículo se describen los mensajes de error y las resoluciones que pueden ayudar a solucionar los problemas de los volúmenes de Azure NetApp Files. 

## <a name="errors-for-smb-and-dual-protocol-volumes"></a>Errores de volúmenes SMB y de protocolo dual

|     Condiciones del error    |     Soluciones    |
|-|-|
| Se produce el siguiente error durante la creación del volumen SMB o de protocolo dual: <br> `{"code":"DeploymentFailed","message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/DeployOperations for usage details.","details":[{"code":"InternalServerError", "message":"Error when creating - Could not query DNS server. Verify that the network configuration is correct and that DNS servers are available."}]}` | Este error indica que no se puede obtener acceso al servidor DNS. <br> Considere las soluciones siguientes: <ul><li>Compruebe si ADDS y el volumen se están implementando en la misma región.</li> <li>Compruebe si ADDS y el volumen están usando la misma red virtual. Si están usando redes virtuales diferentes, asegúrese de que las redes virtuales estén emparejadas entre sí. Consulte [Instrucciones para el planeamiento de red de Azure NetApp Files](azure-netapp-files-network-topologies.md). </li> <li>Es posible que el servidor DNS tenga aplicados grupos de seguridad de red (NSG).  Por lo tanto, no permite que el tráfico fluya. En este caso, abra los NSG en el DNS o AD para conectarse a varios puertos. Para ver los requisitos de los puertos, consulte [Requisitos para las conexiones de Active Directory](create-active-directory-connections.md#requirements-for-active-directory-connections). </li></ul> <br>Las mismas soluciones se aplican a Azure ADDS. Azure ADDS debe implementarse en la misma región. La red virtual debe estar en la misma región o debe emparejarse con la red virtual que usa el volumen. | 
| Se produce el siguiente error durante la creación del volumen SMB o de protocolo dual: <br> `{"code":"DeploymentFailed","message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/DeployOperations for usage details.","details":[{"code":"InternalServerError", "message":"Error when creating - Failed to create the Active Directory machine account \"SMBTESTAD-C1C8\". Reason: Kerberos Error: Invalid credentials were given Details: Error: Machine account creation procedure failed\n [ 563] Loaded the preliminary configuration.\n**[ 670] FAILURE: Could not authenticate as 'test@contoso.com':\n** Unknown user (KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN)\n. "}]}`  |  <ul><li>Asegúrese de que el nombre de usuario especificado sea correcto. </li> <li>Asegúrese de que el usuario forma parte del grupo de administradores que tiene el privilegio para crear cuentas de máquina. </li> <li> Si usa Azure ADDS, asegúrese de que el usuario forma parte del grupo de Azure AD `Azure AD DC Administrators`. </li></ul> | 
| Se produce el siguiente error durante la creación del volumen SMB o de protocolo dual: <br> `{"code":"DeploymentFailed","message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/DeployOperations for usage details.","details":[{"code":"InternalServerError", "message":"Error when creating - Failed to create the Active Directory machine account \"SMBTESTAD-A452\". Reason: Kerberos Error: Pre-authentication information was invalid Details: Error: Machine account creation procedure failed\n [ 567] Loaded the preliminary configuration.\n [ 671] Successfully connected to ip 10.x.x.x, port 88 using TCP\n**[ 1099] FAILURE: Could not authenticate as\n** 'user@contoso.com': CIFS server account password does\n** not match password stored in Active Directory\n** (KRB5KDC_ERR_PREAUTH_FAILED)\n. "}]}` | Asegúrese de que la contraseña especificada para unirse a la conexión de AD sea correcta. |
| Se produce el siguiente error durante la creación del volumen SMB o de protocolo dual: <br> `{"code":"DeploymentFailed","message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/DeployOperations for usage details.","details":[{"code":"InternalServerError","message":"Error when creating - Failed to create the Active Directory machine account \"SMBTESTAD-D9A2\". Reason: SecD Error: ou not found Details: Error: Machine account creation procedure failed\n [ 561] Loaded the preliminary configuration.\n [ 665] Successfully connected to ip 10.x.x.x, port 88 using TCP\n [ 1039] Successfully connected to ip 10.x.x.x, port 389 using TCP\n**[ 1147] FAILURE: Specifed OU 'OU=AADDC Com' does not exist in\n** contoso.com\n. "}]}` | Asegúrese de que la ruta de acceso de unidad organizativa especificada para unirse a la conexión de AD sea correcta. Si usa Azure ADDS, asegúrese de que la ruta de acceso de unidad organizativa sea `OU=AADDC Computers`. |
| Se produce el siguiente error durante la creación del volumen SMB o de protocolo dual: <br> `Failed to create the Active Directory machine account \"SMB-ANF-VOL. Reason: LDAP Error: Local error occurred Details: Error: Machine account creation procedure failed. [nnn] Loaded the preliminary configuration. [nnn] Successfully connected to ip 10.x.x.x, port 88 using TCP [nnn] Successfully connected to ip 10.x.x.x, port 389 using [nnn] Entry for host-address: 10.x.x.x not found in the current source: FILES. Ignoring and trying next available source [nnn] Source: DNS unavailable. Entry for host-address:10.x.x.x found in any of the available sources\n*[nnn] FAILURE: Unable to SASL bind to LDAP server using GSSAPI: local error [nnn] Additional info: SASL(-1): generic failure: GSSAPI Error: Unspecified GSS failure. Minor code may provide more information (Cannot determine realm for numeric host address) [nnn] Unable to connect to LDAP (Active Directory) service on contoso.com (Error: Local error) [nnn] Unable to make a connection (LDAP (Active Directory):contosa.com, result: 7643. `  | Es posible que falte el registro de puntero (PTR) del equipo host de AD en el servidor DNS. Tiene que crear una zona de búsqueda inversa en el servidor DNS y luego agregar un registro de puntero (PTR) del equipo host de AD a esa zona de búsqueda inversa. <br> Por ejemplo, supongamos que la dirección IP de la máquina de AD es `10.x.x.x`, que el nombre de host de la máquina de AD (que se encuentra mediante el comando `hostname`) es `AD1` y el nombre de dominio es `contoso.com`.  El registro PTR agregado a la zona de búsqueda inversa debe ser `10.x.x.x` -> `contoso.com`.   | 
| Se produce el siguiente error durante la creación del volumen SMB o de protocolo dual: <br> `Failed to create the Active Directory machine account \"SMB-ANF-VOL\". Reason: Kerberos Error: KDC has no support for encryption type Details: Error: Machine account creation procedure failed [nnn]Loaded the preliminary configuration. [nnn]Successfully connected to ip 10.x.x.x, port 88 using TCP [nnn]FAILURE: Could not authenticate as 'contosa.com': KDC has no support for encryption type  (KRB5KDC_ERR_ETYPE_NOSUPP) ` | Asegúrese de que el [cifrado AES](./create-active-directory-connections.md#create-an-active-directory-connection) está habilitado en la conexión de Active Directory y para la cuenta de servicio. |
| Se produce el siguiente error durante la creación del volumen SMB o de protocolo dual: <br> `Failed to create the Active Directory machine account \"SMB-NTAP-VOL\". Reason: LDAP Error: Strong authentication is required Details: Error: Machine account creation procedure failed\n [ 338] Loaded the preliminary configuration.\n [ nnn] Successfully connected to ip 10.x.x.x, port 88 using TCP\n [ nnn ] Successfully connected to ip 10.x.x.x, port 389 using TCP\n [ 765] Unable to connect to LDAP (Active Directory) service on\n dc51.area51.com (Error: Strong(er) authentication\n required)\n*[ nnn] FAILURE: Unable to make a connection (LDAP (Active\n* Directory):contoso.com), result: 7609\n. "` | La opción Firma de LDAP no está seleccionada, pero el cliente de AD tiene firma de LDAP.  [Habilite la firma de LDAP](create-active-directory-connections.md#create-an-active-directory-connection) y vuelva a intentarlo. | 

## <a name="errors-for-dual-protocol-volumes"></a>Errores para los volúmenes de protocolo dual

|     Condiciones del error    |     Soluciones    |
|-|-|
| Está habilitado LDAP sobre TLS y se produce un error al crear el volumen de protocolo dual: `This Active Directory has no Server root CA Certificate`.    |     Si este error se produce al crear un volumen de protocolo dual, compruebe que el certificado de la entidad de certificación raíz se haya cargado en su cuenta de NetApp.    |
| Se produce un error al crear el volumen de protocolo dual: `Failed to validate LDAP configuration, try again after correcting LDAP configuration`.    |  Es posible que falte el registro de puntero (PTR) del equipo host de AD en el servidor DNS. Tiene que crear una zona de búsqueda inversa en el servidor DNS y luego agregar un registro de puntero (PTR) del equipo host de AD a esa zona de búsqueda inversa. <br> Por ejemplo, supongamos que la dirección IP de la máquina de AD es `10.x.x.x`, que el nombre de host de la máquina de AD (que se encuentra mediante el comando `hostname`) es `AD1` y el nombre de dominio es `contoso.com`.  El registro PTR agregado a la zona de búsqueda inversa debe ser `10.x.x.x` -> `contoso.com`.   |
| Se produce un error al crear el volumen de protocolo dual: `Failed to create the Active Directory machine account \\\"TESTAD-C8DD\\\". Reason: Kerberos Error: Pre-authentication information was invalid Details: Error: Machine account creation procedure failed\\n [ 434] Loaded the preliminary configuration.\\n [ 537] Successfully connected to ip 10.x.x.x, port 88 using TCP\\n**[ 950] FAILURE`. |     Este error indica que la contraseña de AD es incorrecta cuando Active Directory está unido a la cuenta de NetApp. Actualice la conexión de AD con la contraseña correcta e inténtelo de nuevo. |
| Se produce un error al crear el volumen de protocolo dual: `Could not query DNS server. Verify that the network configuration is correct and that DNS servers are available`. |   Este error indica que no se puede obtener acceso al servidor DNS. La razón puede ser que la dirección IP del servidor DNS sea incorrecta o que haya un problema de red. Compruebe la dirección IP de DNS especificada en la conexión de AD y asegúrese de que sea correcta. <br> Asegúrese también de que AD y el volumen estén en la misma región y en la misma red virtual. Si están en redes virtuales diferentes, asegúrese de establecer un emparejamiento entre las dos redes virtuales. <br> Consulte [Directrices para el planeamiento de red de Azure NetApp Files](azure-netapp-files-network-topologies.md#azure-native-environments) para una información más detallada. |
| Error de denegación de permiso al montar un volumen de protocolo dual. | Un volumen de protocolo dual admite los protocolos NFS y SMB.  Al intentar obtener acceso al volumen montado en el sistema UNIX, el sistema intenta asignar el usuario de UNIX que utiliza a un usuario de Windows. Si no se encuentra ninguna asignación, se produce el error "Permiso denegado". <br> Esta situación se aplica también cuando se usa el usuario "raíz" para obtener acceso. <br> Para evitar el problema de tipo "Permiso denegado", asegúrese de que Active Directory para Windows incluya `pcuser` antes de obtener acceso al punto de montaje. Si agrega `pcuser` después de encontrar el problema "Permiso denegado", espere 24 horas para que la entrada de caché se borre antes de volver a intentar el acceso. |

## <a name="errors-for-nfsv41-kerberos-volumes"></a>Errores de volúmenes Kerberos NFSv4.1

|     Condiciones del error    |     Soluciones    |
|-|-|
|`Error allocating volume - Export policy rules does not match kerberosEnabled flag` | Azure NetApp Files no admite Kerberos para los volúmenes de NFSv3. Kerberos solo es compatible con el protocolo de NFSv4.1.  |
|`This NetApp account has no configured Active Directory   connections`  |  Configure Active Directory para la cuenta de NetApp con los campos **KDC IP** y **Nombre del servidor de AD**. Consulte [Configuración de Azure Portal](configure-kerberos-encryption.md#configure-the-azure-portal) para obtener instrucciones. |
|`Mismatch between KerberosEnabled flag value and ExportPolicyRule's access type parameter values.`  | Azure NetApp Files no admite la conversión de un volumen de NFSv4.1 sin formato en un volumen de NFSv4.1 de Kerberos y viceversa. |
|`mount.nfs: access denied by server when mounting volume <SMB_SERVER_NAME-XXX.DOMAIN_NAME>/<VOLUME_NAME>` <br>  Ejemplo: `smb-test-64d9.contoso.com:/nfs41-vol101` | <ol><li> Asegúrese de que los registros A/PTR están configurados correctamente y existen en la instancia de Active Directory correspondiente al nombre de servidor `smb-test-64d9.contoso.com`. <br> En el cliente NFS, si `nslookup` de `smb-test-64d9.contoso.com` se resuelve en la dirección IP IP1 (es decir, `10.1.1.68`), después `nslookup` de IP1 debe resolverse en un solo registro (es decir, `smb-test-64d9.contoso.com`). `nslookup` de IP1 *no debe* resolverse en varios nombres. </li>  <li>Establezca AES-256 para la cuenta de máquina NFS de tipo `NFS-<Smb NETBIOS NAME>-<few random characters>` en AD mediante PowerShell o la interfaz de usuario. <br> Comandos de ejemplo: <ul><li>`Set-ADComputer <NFS_MACHINE_ACCOUNT_NAME> -KerberosEncryptionType AES256` </li><li>`Set-ADComputer NFS-SMB-TEST-64 -KerberosEncryptionType AES256` </li></ul> </li> <li>Asegúrese de que la hora del cliente NFS, AD y el software de almacenamiento de Azure NetApp Files estén sincronizadas entre sí y se encuentren dentro de un rango de sesgo de cinco minutos. </li>  <li>Obtenga el vale de Kerberos correspondiente al cliente NFS mediante el comando `kinit <administrator>`.</li> <li>Reduzca el nombre de host del cliente NFS a menos de 15 caracteres y vuelva a realizar la operación realm join. </li><li>Reinicie el cliente NFS y el servicio `rpcgssd` como se indica a continuación. El comando puede variar en función del sistema operativo.<br> RHEL 7: <br> `service nfs restart` <br> `service rpcgssd restart` <br> CentOS 8: <br> `systemctl enable nfs-client.target && systemctl start nfs-client.target` <br> Ubuntu: <br> (Reinicie el servicio `rpc-gssd`). <br> `sudo systemctl start rpc-gssd.service` </ul>| 
|`mount.nfs: an incorrect mount option was specified`   | El problema puede estar relacionado con el problema del cliente NFS. Reinicie el cliente NFS.    |
|`Hostname lookup failed`   | Tiene que crear una zona de búsqueda inversa en el servidor DNS y luego agregar un registro de puntero (PTR) del equipo host de AD a esa zona de búsqueda inversa. <br> Por ejemplo, supongamos que la dirección IP de la máquina de AD es `10.1.1.4`, que el nombre de host de la máquina de AD (que se encuentra mediante el comando hostname) es `AD1` y el nombre de dominio es `contoso.com`. El registro PTR agregado a la zona de búsqueda inversa debe ser `10.1.1.4 -> AD1.contoso.com`. |
|`Volume creation fails due to unreachable DNS server`  | Existen dos posibles soluciones: <br> <ul><li> Este error indica que no se puede obtener acceso al servidor DNS. El motivo puede ser una dirección IP de DNS incorrecta o un problema de red. Compruebe la dirección IP de DNS especificada en la conexión de AD y asegúrese de que sea correcta. </li> <li> Asegúrese de que AD y el volumen estén en la misma región y en la misma red virtual. Si están en redes virtuales diferentes, asegúrese de establecer un emparejamiento entre las dos redes virtuales. </li></ul> |
|La creación del volumen de NFSv4.1 de Kerberos genera un error similar al ejemplo siguiente: <br> `Failed to enable NFS Kerberos on LIF "svm_e719cde8d6d0413fbd6adac0636cdecb_7ad0b82e_73349613". Failed to bind service principal name on LIF "svm_e719cde8d6d0413fbd6adac0636cdecb_7ad0b82e_73349613". SecD Error: server create fail join user auth.` |La dirección IP de KDC es incorrecta y se ha creado el volumen de Kerberos. Actualice la dirección IP de KDC con una dirección correcta. <br> Después de actualizar la dirección IP de KDC, el error no desaparecerá. Debe volver a crear el volumen. |

## <a name="errors-for-ldap-volumes"></a>Errores de volúmenes LDAP

|     Condiciones del error    |     Soluciones    |
|-|-|
| Error al crear un volumen SMB con el parámetro ldapEnabled como true: <br> `Error Message: ldapEnabled option is only supported with NFS protocol volume. ` | No se puede crear un volumen SMB con la opción LDAP habilitada. <br> Cree volúmenes SMB con la opción LDAP deshabilitada. |
| Error al actualizar el valor del parámetro ldapEnabled para un volumen existente: <br> `Error Message: ldapEnabled parameter is not allowed to update` |  No se puede modificar la configuración de la opción LDAP después de crear un volumen. <br> No actualice la configuración de la opción LDAP en un volumen ya creado. Consulte [Configuración de ADDS LDAP con grupos extendidos para el acceso a volúmenes NFS](configure-ldap-extended-groups.md) para más información. |
| Error al crear un volumen NFS habilitado para LDAP: <br> `Could not query DNS server` <br> `Sample error message:` <br> `"log": time="2020-10-21 05:04:04.300" level=info msg=Res method=GET url=/v2/Volumes/070d0d72-d82c-c893-8ce3-17894e56cea3  x-correlation-id=9bb9e9fe-abb6-4eb5-a1e4-9e5fbb838813 x-request-id=c8032cb4-2453-05a9-6d61-31ca4a922d85 xresp="200:  {\"created\":\"2020-10-21T05:02:55.000Z\",\"lifeCycleState\":\"error\",\"lifeCycleStateDetails\":\"Error when creating - Could not query DNS server. Verify that the network configuration is correct and that DNS servers are available.\",\"name\":\"smb1\",\"ownerId\ \":\"8c925a51-b913-11e9-b0de-9af5941b8ed0\",\"region\":\"westus2stage\",\"volumeId\":\"070d0d72-d82c-c893-8ce3-` |  Este error se produce porque no se puede acceder al DNS. <br> <ul><li> Compruebe si ha configurado el sitio correcto (ámbito de sitio) para Azure NetApp Files. </li><li> La razón por la que el DNS es inaccesible puede ser una dirección IP de DNS incorrecta o problemas de red. Compruebe la dirección IP de DNS especificada en la conexión de AD para asegurarse de que es correcta. </li><li> Asegúrese de que AD y el volumen estén en la misma región y en la misma red virtual. Si están en redes virtuales diferentes, asegúrese de establecer un emparejamiento entre las dos redes virtuales.</li></ul> |
| Error al crear un volumen a partir de una instantánea: <br> `Aggregate does not exist` | Azure NetApp Files no admite el aprovisionamiento de un nuevo volumen habilitado para LDAP a partir de una instantánea que pertenece a un volumen que no está habilitado para LDAP. <br> Intente crear un nuevo volumen que no está habilitado para LDAP a partir de la instantánea especificada. |

## <a name="errors-for-volume-allocation"></a>Errores de asignación de volúmenes 

Al crear un nuevo volumen o cambiar el tamaño de uno existente en Azure NetApp Files, Microsoft Azure asigna recursos de red y almacenamiento a la suscripción. A veces se pueden experimentar errores de asignación de recursos debido al crecimiento sin precedentes de la demanda de servicios de Azure en determinadas regiones.

En esta sección se explican las causas de algunos de los errores de asignación más comunes y se sugieren posibles soluciones.

|     Condiciones del error    |     Soluciones    |
|-|-|
|Error al crear nuevos volúmenes o al cambiar el tamaño de volúmenes existentes. <br> Mensaje de error: `There was a problem locating [or extending] storage  for the volume. Please retry the operation. If the problem persists, contact Support.` | El error indica que el servicio se ha encontrado con un error al intentar asignar recursos para esta solicitud. <br> Vuelva a intentar la operación más tarde. Póngase en contacto con Soporte técnico si el problema persiste.|
|Sin capacidad de almacenamiento o red en una región para volúmenes normales. <br> Mensaje de error: `There are currently insufficient resources available to create [or extend] a volume in this region. Please retry the operation. If the problem persists, contact Support.` | El error indica que no hay recursos suficientes disponibles en la región para crear volúmenes o cambiar su tamaño. <br> Pruebe alguna de las siguientes soluciones alternativas: <ul><li>Cree el volumen en una nueva red virtual. Con esto evita alcanzar los límites de recursos relacionados con las redes.</li> <li>Vuelva a intentarlo más tarde. Entre tanto se pueden haber liberado recursos en el clúster, la región o la zona.</li></ul> |
|Sin capacidad de almacenamiento al crear un volumen con características de red establecidas en `Standard`. <br> Mensaje de error: `No storage available with Standard network features, for the provided VNet.` | El error indica que no hay recursos suficientes disponibles en la región para crear volúmenes con características de red `Standard`. <br> Pruebe alguna de las siguientes soluciones alternativas: <ul><li>Si no se requieren características de red `Standard`, cree el volumen con características de red `Basic`.</li> <li>Intente crear el volumen en una nueva red virtual. Con esto evita alcanzar los límites de recursos relacionados con las redes.</li><li>Vuelva a intentarlo más tarde.  Entre tanto se pueden haber liberado recursos en el clúster, la región o la zona.</li></ul> |

## <a name="next-steps"></a>Pasos siguientes  

* [Creación de un volumen de NFS para Azure NetApp Files](azure-netapp-files-create-volumes.md)
* [Cree un volumen SMB para Azure NetApp Files](azure-netapp-files-create-volumes-smb.md) 
* [Creación de un volumen de dos protocolos para Azure NetApp Files](create-volumes-dual-protocol.md) 
* [Configuración de las características de red de un volumen](configure-network-features.md)
