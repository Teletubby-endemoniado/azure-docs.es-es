### YamlMime:FAQ
metadata:
  title: 'Preguntas frecuentes: copia de seguridad de bases de datos de SAP HANA en máquinas virtuales de Azure'
  description: En este artículo, descubra las respuestas a preguntas comunes sobre la copia de seguridad de bases de datos de SAP HANA con el servicio Azure Backup.
  ms.topic: article
  ms.service: backup
  ms.date: 09/27/2021
  ms.openlocfilehash: 2b1a7e39c1cf4a7e6c5b1da6f748c7e143608104
  ms.sourcegitcommit: 10029520c69258ad4be29146ffc139ae62ccddc7
  ms.translationtype: HT
  ms.contentlocale: es-ES
  ms.lasthandoff: 09/27/2021
  ms.locfileid: "129080701"
title: 'Preguntas frecuentes: copia de seguridad de bases de datos de SAP HANA en máquinas virtuales de Azure'
summary: Este artículo responde preguntas comunes sobre la copia de seguridad de bases de datos de SAP HANA con el servicio Azure Backup.
sections:
- name: Copia de seguridad
  questions:
  - question: >
      ¿Cuántas copias de seguridad completas se admiten al día?
    answer: >
      Puede tener una copia de seguridad completa programada y varias copias de seguridad a petición en un día.


      | Tipos de copia de seguridad | Copia de seguridad programada | Copia de seguridad a petición |

      | --- | --- | --- |

      | Completo | Solo se admite una por día. | Se admiten varias por día. |

      | Diferencial/incremental | Solo se admite una por día. <br><br> **Nota** <br> Las copias de seguridad diferenciales solo se pueden programar cuando no hay programada ninguna copia de seguridad completa para el día en concreto. Además, solo se puede programar un tipo de copia de seguridad diferencial o incremental en una directiva de copia de seguridad. | Se admiten varias por día. |
  - question: >
      ¿Dónde puedo encontrar alertas relacionadas con copias de seguridad?
    answer: >
      Actualmente, los trabajos de copia de seguridad correctos no generan alertas. Solo se generan alertas para los trabajos de copia de seguridad con errores. [Obtenga información](backup-azure-monitoring-built-in-monitor.md) sobre cómo usar Azure Portal para ver alertas de copias de seguridad.
  - question: >
      ¿Cómo puedo comprobar si la copia de seguridad (programada o a petición) se ha ejecutado correctamente?
    answer: "Puede comprobar el estado de las copias de seguridad (programadas o a petición) desde cualquiera de las siguientes ubicaciones:\n\n1. **Trabajos de copia de seguridad**: Azure Backup muestra todos los trabajos desencadenados manualmente en la sección \"Trabajos de copia de seguridad\" de Azure Portal.  <br><br>   Los trabajos que ve en Azure Portal incluyen operaciones de detección y registro de bases de datos, y operaciones de copia de seguridad y restauración. Los trabajos programados, incluidas las copias de seguridad de registros, no se muestran en esta sección. Las copias de seguridad desencadenadas manualmente desde los clientes nativos de SAP HANA (Studio/Cockpit/DBA Cockpit) tampoco se muestran aquí.\n\n   :::image type=\"content\" source=\"./media/sap-hana-faq-backup-azure-vm/manually-triggered-jobs.png\" alt-text=\"Captura de pantalla que muestra los trabajos desencadenados manualmente en la sección &quot;Trabajos de copia de seguridad&quot; de Azure Portal.\":::\n\n   :::image type=\"content\" source=\"./media/sap-hana-faq-backup-azure-vm/jobs-and-operations-list.png\" alt-text=\"Captura de pantalla que muestra trabajos con operaciones de detección y registro de bases de datos y de copia de seguridad y restauración.\":::\n \n1. **Alertas de copia de seguridad**: las alertas le ayudan a supervisar las copias de seguridad de las bases de datos de SAP HANA. De esta forma, puede centrarse en los eventos necesarios, lo que elimina el esfuerzo de comprobar con frecuencia la gran cantidad de eventos que genera una copia de seguridad. Para obtener más información, consulte [Visualización de alertas de copia de seguridad](/azure/backup/sap-hana-db-manage#view-backup-alerts).\n\n1. **Informes de copia de seguridad**: los informes son otra manera de ver el estado de los trabajos de copia de seguridad. Los informes serán como los que se muestran a continuación:\n\n   :::image type=\"content\" source=\"./media/sap-hana-faq-backup-azure-vm/backup-reports.png\" alt-text=\"Captura de pantalla que muestra un tipo de informe en Azure Portal.\":::\n\n   :::image type=\"content\" source=\"./media/sap-hana-faq-backup-azure-vm/backup-reports-mabs.png\" alt-text=\"Captura de pantalla que muestra el otro tipo de informe en Azure Portal.\":::\n\n   Obtenga más información sobre la [configuración de informes de Azure Backup](/azure/backup/configure-reports).\n\n1. **Clientes nativos de SAP HANA**: si es un cliente SAP HANA, también puede usar HANA Studio, uno de los clientes de HANA más comunes. En este cliente, vaya a la **Consola de copias de seguridad** -> **Catálogo de copias de seguridad** para comprobar el **Estado de copia de seguridad**.\n\n   :::image type=\"content\" source=\"./media/sap-hana-faq-backup-azure-vm/sap-hana-native-client-reports.png\" alt-text=\"Captura de pantalla que muestra informes en los clientes nativos de SAP HANA.\":::\n"
  - question: >
      ¿Se pueden ver los trabajos de copia de seguridad programados en el menú de Trabajos de copia de seguridad?
    answer: >
      En el menú "Trabajos de copia de seguridad" solo se mostrarán los trabajos de copia de seguridad a petición que estén en curso, se hayan completado correctamente o hayan dado error. Para los trabajos programados, use [Azure Monitor](./backup-azure-monitoring-use-azuremonitor.md).
  - question: >
      ¿Cuál es el período de retención de las copias de seguridad completas de recuperación automática desencadenadas debido a los errores LSNValidation?
    answer: >
      Azure Backup no establece un período de retención explícito en las copias de seguridad completas de recuperación automática. Esta copia de seguridad se conserva hasta el momento en que se conserven las copias de seguridad delta (diferenciales o incrementales) y las copias de seguridad de registros dependientes. Una vez eliminada la última copia de seguridad dependiente de esta copia de seguridad de recuperación automática, también se elimina la copia de seguridad de recuperación automática.
  - question: >
      ¿Las bases de datos futuras se agregan automáticamente para copia de seguridad?
    answer: >
      No, no se admite actualmente.
  - question: >
      Si elimino una base de datos de una instancia, ¿qué ocurrirá con las copias de seguridad?
    answer: >
      Si se elimina una base de datos de una instancia de SAP HANA, se siguen intentando las copias de seguridad de la base de datos. Esto implica que la base de datos eliminada comienza a aparecer como incorrecta en **Elementos de copia de seguridad** y todavía está protegida.

      La manera correcta de detener la protección de esta base de datos es realizar una acción **Detener copia de seguridad con eliminación de datos** en esta base de datos.
  - question: >
      Si se cambia el nombre de la base de datos después de haberla protegido, ¿cuál será el comportamiento?
    answer: >
      Una base de datos después de un cambio de nombre se trata como una nueva base de datos. Por lo tanto, el servicio trata esta situación como si no se encontrara la base de datos y producirá un error en las copias de seguridad. La base de datos cuyo nombre se ha cambiado aparecerá como una nueva base de datos y se debe configurar su protección.
  - question: >
      ¿Cómo empiezo a hacer copias de seguridad de mis bases de datos SAP HANA usando Azure Backup?
    answer: >
      En el [tutorial](./tutorial-backup-sap-hana-db.md) encontrará una guía paso a paso para empezar a usar Azure Backup con bases de datos SAP HANA. También puede usar la [CLI](./tutorial-sap-hana-backup-cli.md) para configurar y administrar copias de seguridad.
  - question: >
      ¿Existen requisitos previos para hacer copias de seguridad de bases de datos SAP HANA usando Azure Backup?
    answer: >
      Consulte los [requisitos previos](./tutorial-backup-sap-hana-db.md#prerequisites) para usar Azure Backup con SAP HANA.
  - question: >
      ¿Funcionarán las copias de seguridad después de migrar SAP HANA de SDC a MDC?
    answer: >
      Consulte [esta sección](./backup-azure-sap-hana-database-troubleshoot.md#sdc-to-mdc-upgrade-with-a-change-in-sid) de la guía de solución de problemas.
  - question: >
      ¿Cómo me aseguro de que las copias de seguridad continúan después de actualizar mi instancia de HANA dentro de la misma versión de la solución?
    answer: >
      Consulte [esta sección](backup-azure-sap-hana-database-troubleshoot.md#sdc-version-upgrade-or-mdc-version-upgrade-on-the-same-vm) en la guía de solución de problemas.
  - question: >
      ¿Se puede configurar la copia de seguridad de Azure HANA en una IP virtual (equilibrador de carga) y no en una máquina virtual?
    answer: >
      Actualmente no tenemos la posibilidad de configurar la solución con relación a una IP virtual o un proxy. Se necesita una máquina virtual para ejecutar la solución.
  - question: >
      ¿Cómo puedo trasladar una copia de seguridad a petición al sistema de archivos local en lugar de al almacén de Azure?
    answer: >
      1. Espere a que se complete la copia de seguridad que se está ejecutando actualmente en la base de datos deseada (comprobar en Studio si ha finalizado).

      1. Deshabilite las copias de seguridad de registros y establezca la copia de seguridad del catálogo en **Filesystem** para la base de que desee siguiendo estos pasos:

      1. Haga doble clic en **SYSTEMDB** -> **Configuración** -> **Seleccionar base de datos** -> **Filtro (registro)** .
          1. Establezca enable_auto_log_backup en **No**.
          1. Establezca catalog_backup_using_backint en **false**.
      1. Realice una copia de seguridad a petición (completa, diferencial o incremental) de la base de datos deseada y espere a que se completen la copia de seguridad del catálogo y la copia de seguridad completa.

      1. Si también desea trasladar las copias de seguridad de registros al sistema de archivos, establezca enable_auto_log_backup en **sí**.

      1. Revierta a la configuración anterior para permitir que las copias de seguridad fluyan al almacén de Azure:
          1. Establezca enable_auto_log_backup en **Sí**.
          1. Establezca catalog_backup_using_backint en **true**.

      > [!NOTE]

      > Trasladar las copias de seguridad al sistema de archivos local y volver a cambiar a Azure Vault puede provocar una interrupción de la cadena de registro de las copias de seguridad del registro en el almacén. Esto desencadenará una copia de seguridad completa, que una vez realizada correctamente, comenzará a ejecutar la copia de seguridad de los registros.
  - question: >
      ¿Cómo puedo usar la copia de seguridad de SAP HANA con la configuración de la replicación de HANA?
    answer: >
      Actualmente, Azure Backup no tiene la capacidad de comprender una configuración de HSR. Esto significa que los nodos principal y secundario del HSR se tratarán como dos máquinas virtuales individuales no relacionadas. Primero deberá configurar la copia de seguridad en el nodo principal. Cuando se produce una conmutación por error, se debe configurar la copia de seguridad en el nodo secundario (que ahora se convierte en el nodo principal). No hay ninguna conmutación errónea automática de la copia de seguridad en el otro nodo.


      Para realizar una copia de seguridad de los datos del nodo activo (principal) en un momento dado, puede **cambiar la protección** al nodo secundario, que ahora se convierte en el principal después de la conmutación por error.


      Para realizar este **cambio de la protección**, siga estos pasos:


      - [Detener la protección](sap-hana-db-manage.md#stop-protection-for-an-sap-hana-database) (con conservación de datos) en el nodo principal

      - Ejecutar el [script de registro previo](https://go.microsoft.com/fwlink/?linkid=2173610) en el nodo secundario

      - [Detectar las bases de datos](tutorial-backup-sap-hana-db.md#discover-the-databases) en el nodo secundario y [configurar las copias de seguridad](tutorial-backup-sap-hana-db.md#configure-backup) en ellas


      Estos pasos deben realizarse manualmente después de cada conmutación por error. Puede realizar estos pasos mediante la línea de comandos/REST de HTTP y en Azure Portal. Para automatizar estos pasos, puede usar un runbook de Azure.


      A continuación, se muestra un ejemplo detallado de cómo se debe realizar el **cambio de la protección**:


      En este ejemplo, tiene dos nodos: nodo 1 (principal) y nodo 2 (secundario) en la configuración del HSR.  Las copias de seguridad se configuran en el nodo 1. Como se mencionó anteriormente, no intente configurar las copias de seguridad en el nodo 2.


      Cuando se produce la primera conmutación por error, el nodo 2 se convierte en el principal. A continuación,


      1. Detenga la protección del nodo 1 (principal anterior) con la opción de conservación de datos.

      1. Ejecute el script de registro previo en el nodo 2 (que ahora es el principal).

      1. Detecte bases de datos en el nodo 2, asigne directivas de copia de seguridad y configure copias de seguridad.


      A continuación, se desencadena una primera copia de seguridad completa en el nodo 2 y, una vez completada, se inician las copias de seguridad de los registros.


      Cuando se produce la siguiente conmutación por error, el nodo 1 vuelve a ser principal y el nodo 2 se convierte en secundario. Ahora repita el proceso:


      1. Detenga la protección del nodo 2 con la opción de conservación de datos.

      1. Ejecute el script de registro previo en el nodo 1 (que se ha convertido de nuevo en el principal).

      1. A continuación, [reanude la copia de seguridad](sap-hana-db-manage.md#resume-protection-for-an-sap-hana-database) en el nodo 1 con la directiva necesaria (ya que las copias de seguridad se detuvieron antes en el nodo 1).


      A continuación, se desencadenará de nuevo una copia de seguridad completa en el nodo 1 y, una vez completada, se inician las copias de seguridad de los registros.


      >[!Note]

      >[La ejecución del script previo al registro](./tutorial-backup-sap-hana-db.md#prerequisites) con el usuario de copia de seguridad personalizado como entrada podría ayudarle a administrar mejor las copias de seguridad de HSR. Esto se debe a que garantiza que ambos nodos de la configuración de HSR tienen la misma clave de copia de seguridad, lo que reduce los problemas de sincronización y los errores de copia de seguridad.
  - question: >
      ¿Qué ocurre si no detengo la protección (con conservación de los datos) del nodo secundario o inactivo en la configuración de HSR?
    answer: >
      1. En el caso de la replicación del sistema HANA (HSR), el nodo secundario no acepta ninguna conexión. Una vez configurada la copia de seguridad, el servicio de Azure Backup hace ping periódicamente y produce un error. A veces estos intentos con errores se reflejan en el nodo principal. Después de varios errores, el usuario se bloquea y, a continuación, el nodo principal comienza a producir un error con _ODBCConnectionError_.   <br><br>Hemos observado que no todos los usuarios experimentan esta incidencia. Se recomienda que usted o SAP investiguen la causa del bloqueo de los usuarios en el nodo principal cuando se produce un error en la conexión del usuario del nodo secundario.


      1. Una vez ejecutado el script de registro previo, la información del usuario se actualiza con una nueva contraseña en el nodo principal. A continuación, se volverá a establecer la conexión para intentar realizar la copia de seguridad. No obstante, es posible que vuelva a experimentar el mismo escenario.


      1. Además, las copias de seguridad (copias de seguridad completas) que no se pueden realizar en el nodo secundario crean alertas.


      Para evitar los problemas anteriores, se recomienda detener la protección de un nodo cuando se convierta en secundario (para que las conexiones no se intenten y el usuario no se bloquee) y reanudar la protección una vez que se convierta en principal. Si no se enfrenta a esta situación de bloqueo en sus configuraciones de HSR y se encuentra cómodo con las alertas que se están generando, puede configurar las copias de seguridad en ambos nodos para que el servicio administre la toma de control y la conmutación por recuperación.
  - question: >
      ¿Cuál es el rendimiento de copia de seguridad y restauración que Azure Backup proporciona y cómo puedo configurar el sistema HANA para usar este rendimiento máximo?
    answer: >
      Consulte el [rendimiento de las copias de seguridad y restauraciones](/azure/backup/tutorial-backup-sap-hana-db#understanding-backup-and-restore-throughput-performance) que ofrece Azure Backup para las cargas de trabajo de HANA. <br><br> Para configurar el sistema HANA a fin de aprovechar el rendimiento mejorado, use los siguientes recursos:

       - [Selección de un tipo de disco para máquinas virtuales IaaS de Azure: discos administrados](/azure/virtual-machines/disks-types#premium-ssd)
       - [Niveles de rendimiento de discos administrados de Azure](/azure/virtual-machines/disks-change-performance)
       - [Serie M](/azure/virtual-machines/m-series)
       - [Configuraciones de almacenamiento de máquinas virtuales de Azure en SAP HANA](/azure/virtual-machines/workloads/sap/hana-vm-operations-storage#solutions-with-premium-storage-and-azure-write-accelerator-for-azure-m-series-virtual-machines)

      >[!Note]

      >También puede limitar el rendimiento de la copia de seguridad. [Más información](/azure/backup/tutorial-backup-sap-hana-db#limiting-backup-throughput-performance).
- name: Restauración
  questions:
  - question: >
      ¿Por qué no puedo ver el sistema HANA en el que deseo que se restaure la base de datos?
    answer: >
      Compruebe si se cumplen todos los requisitos previos para la restauración en la instancia de SAP HANA de destino. Para más información, consulte [Requisitos previos: restauración de bases de datos de SAP HANA en máquinas virtuales de Azure](./sap-hana-db-restore.md#prerequisites).
  - question: >
      ¿Por qué se produce un error en la restauración de la base de datos con sobrescritura para la base de datos?
    answer: >
      Asegúrese de que la opción **Forzar sobrescritura** está seleccionada durante la restauración.
  - question: >
      ¿Por qué veo el mensaje de error "Los sistemas de origen y destino para la restauración no son compatibles"?
    answer: >
      Consulte la Nota [1642148](https://launchpad.support.sap.com/#/notes/1642148) de SAP HANA para ver qué tipos de restauración se admiten actualmente.
  - question: >
      ¿Puedo usar una copia de seguridad de una base de datos que se ejecuta en SLES para la restauración a un sistema RHEL HANA o viceversa?
    answer: >
      Sí, puede usar las copias de seguridad de streaming desencadenadas en una base de datos de HANA que se ejecuta en SLES para restaurarla en un sistema RHEL HANA y viceversa. Es decir, la restauración entre sistemas operativos es posible mediante copias de seguridad de streaming. Sin embargo, tendrá que asegurarse de que el sistema HANA en el que desea realizar la restauración y el sistema HANA que usará para la restauración sean compatibles con la restauración de acuerdo con SAP. Consulte la nota [1642148](https://launchpad.support.sap.com/#/notes/1642148) de SAP HANA para ver qué tipos de restauración son compatibles.
- name: Directiva
  questions:
  - question: >
      Diferentes opciones disponibles durante la creación de una directiva para la copia de seguridad de SAP HANA
    answer: >
      Antes de crear una directiva, debe tener claros los requisitos de RPO y RTO, así como sus costos asociados pertinentes.


      El RPO (objetivo de punto de recuperación) indica cuánta pérdida de datos es aceptable para el usuario o el cliente. Esto lo determina la frecuencia de copia de seguridad de registros. Las copias de seguridad de registros más frecuentes indican un RPO inferior, y el valor mínimo admitido por el servicio Azure Backup es de 15 minutos. Por lo tanto, la frecuencia de copia de seguridad de registros puede ser de 15 minutos o más.


      El RTO (objetivo de punto de recuperación) indica la rapidez con la que se deben restaurar los datos al último momento disponible después de un escenario de pérdida de datos. Esto depende de la estrategia de recuperación empleada por HANA, que suele depender del número de archivos necesarios para la restauración. Esto también genera costos asociados, y la tabla siguiente debería ayudarle a comprender todos los escenarios y sus implicaciones.


      |Directiva de copia de seguridad  |RTO  |Coste  |

      |---------|---------|---------|

      |Completa diaria + registros     |   Lo más rápido, ya que solo necesitamos una copia completa más los registros necesarios para la restauración a un momento dado      |    Lo más económico, ya que se realiza una copia completa diariamente y, por tanto, se acumulan más datos en el back-end hasta el tiempo de retención   |

      |Completa semanal + diaria diferencial + registros     |   Se trata de una opción más lenta que la anterior, pero más rápida que la siguiente, ya que se requiere una copia completa + una copia diferencial + registros para la restauración a un momento dado      |    Opción menos costosa, ya que la copia diferencial diaria suele ser más pequeña que la completa, y la copia completa se realiza solo una vez a la semana      |

      |Completa semanal + incremental diaria + registros     |  Lo más lento, ya que necesitamos una copia completa + "n" incrementales + registros para la restauración a un momento dado       |     Opción más costosa, ya que la copia incremental diaria será más pequeña que la diferencial, y una copia completa se realiza solo cada semana    |


      > [!NOTE]

      > Las opciones anteriores son las más comunes, pero no las únicas. Por ejemplo, puede tener una copia de seguridad completa semanal + diferenciales dos veces a la semana + registros.


      Por lo tanto, puede seleccionar la variante de directiva en función de los objetivos de RPO y RTO y las consideraciones de costos.
  - question: >
      Impacto de la modificación de una directiva
    answer: >
      Deben tenerse en cuenta algunos principios a la hora de determinar el impacto de cambiar la directiva de un elemento de copia de seguridad de la directiva 1 (P1) a la directiva 2 (P2), o de la directiva de edición 1 (P1).


      - Todos los cambios también se aplican de forma retroactiva. La directiva de copia de seguridad más reciente se aplica también a los puntos de recuperación que se realizaron anteriormente. Por ejemplo, supongamos que la retención completa diaria es de 30 días y que se realizaron 10 puntos de recuperación según la directiva activa actualmente. Si la retención diaria completa se cambia a 10 días, la hora de expiración del punto anterior también se vuelve a calcular como la hora de inicio + 10 días, y se elimina si ha expirado.

      - El ámbito del cambio también incluye el día de la copia de seguridad y el tipo de copia de seguridad junto con la retención. Por ejemplo: Si se cambia una directiva de completa diaria a completa semanal todos los domingos, todas las copias completas anteriores no realizadas en domingo se marcarán para su eliminación.

      - No se elimina un elemento primario hasta que el elemento secundario está activo o no haya expirado. Cada tipo de copia de seguridad tiene una hora de expiración de acuerdo con la directiva activa actualmente. Sin embargo, un tipo de copia de seguridad completa se considera como primario para las copias "diferenciales", "incrementales" y los "registros" posteriores. Una copia "diferencial" y un "registro" no son elementos primarios de ningún otro. Una copia "incremental" puede ser un elemento primario de la copia "incremental" posterior. Incluso si un elemento "primario" está marcado para su eliminación, no se elimina realmente si las copias "diferenciales" o los "registros" secundarios no han expirado. Por ejemplo, si se cambia una directiva de completa diaria a completa semanal todos los domingos, todas las copias completas anteriores no realizadas en domingo se marcarán para su eliminación. Sin embargo, no se eliminan realmente hasta que no expiran los registros diarios realizados anteriormente. En otras palabras, se conservan en función de la duración del último registro. Una vez que expiren los registros, se eliminarán los registros y las copias completas.


      Con estos principios, puede leer la siguiente tabla para comprender las implicaciones de un cambio de directiva.


      |Directiva anterior/directiva nueva  |Completas diarias + registros  | Completas semanales + diferenciales diarias + registros  |Completas semanales + incrementales diarias + registros  |

      |---------|---------|---------|---------|

      |Completas diarias + registros     |   -      |    Las copias completas anteriores no realizadas el mismo día de la semana se marcan para su eliminación, pero se mantienen hasta el período de retención del registro     |    Las copias completas anteriores no realizadas el mismo día de la semana se marcan para su eliminación, pero se mantienen hasta el período de retención del registro     |

      |Completas semanales + diferenciales diarias + registros     |   La retención de las copias completas semanales anteriores se vuelve a calcular según la última directiva. Las copias diferenciales anteriores se eliminan inmediatamente      |    -     |    Las copias diferenciales anteriores se eliminan inmediatamente     |

      |Completas semanales + incrementales diarias + registros     |     La retención de las copias completas semanales anteriores se vuelve a calcular según la última directiva. Las copias incrementales anteriores se eliminan inmediatamente    |     Las copias incrementales anteriores se eliminan inmediatamente    |    -     |
additionalContent: "\n## <a name=\"next-steps\"></a>Pasos siguientes\n\nObtenga información sobre cómo [hacer copias de seguridad de bases de datos de SAP HANA](./backup-azure-sap-hana-database.md) que se ejecutan en máquinas virtuales de Azure."
